***
Задача D из рукода 2023
***
Графопостроитель строит чертёж на бумаге.
Графопостроитель работает следующим образом:
• За один шаг рисуется один отрезок.
• Если новый отрезок пересекается с каким-то из существующих отрезков, то он пересекается
ровно по одной точке и точка пересечения не может быть внутренней точкой ни для какого из
отрезков.
Два отрезка считаются принадлежащими одной фигуре, если отрезки соединены прямо или опосредованно, то есть существует последовательность отрезков с одним из этих двух отрезков как
первым элементом, вторым — как последним, обладающая следующим свойством: любые два отрезка, соседние в этой последовательности, имеют общую вершину.
После каждого шага, тем самым, на бумаге нарисовано несколько фигур.
Назовём фигуру забавной, если она может быть нарисована за один росчерк, то есть можно
нарисовать фигуру целиком без отрыва карандаша от бумаги и без рисования какого-либо участка ненулевой длины дважды. При этом не имеет значения, сколько раз были посещены концы
отрезков.
Ваша задача — вывести количество забавных фигур на бумаге после каждого шага графопостроителя.
Формат входных данных
Первая строка входных данных содержит одно целое число N — количество шагов графопостроителя (1 6 N 6 2 · 105
).
i-я из последующих N строк задаёт i-й шаг и содержит четыре целых числа xi,1,
yi,1, xi,2, yi,2 — координаты концов отрезка, начерченного графопостроителем на i-м шаге
(0 6 xi,1, yi,1, xi,2, yi,2 6 109
, длина отрезка строго больше нуля).
Гарантируется, что для каждой пары отрезков их пересечение или пусто, или состоит из одной
точки, которая является концом для обоих отрезков.
Формат выходных данных
Выведите N строк. В i-й строке выведите одно целое число — количество забавных фигур на
бумаге после i-го шага.
